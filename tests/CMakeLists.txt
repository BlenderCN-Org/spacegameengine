FIND_PACKAGE(
	Boost 1.41.0 REQUIRED COMPONENTS
	unit_test_framework
)

MACRO(
	ADD_SGE_TEST
	PATHNAME
)
	STRING(REGEX REPLACE "\\/" "_" TESTNAME ${PATHNAME})

	SET(TESTNAME test_${TESTNAME})

	ADD_EXECUTABLE (${TESTNAME} ${PATHNAME}.cpp)

	IF(MSVC)
		SET_PROPERTY(
			TARGET ${TESTNAME}
			PROPERTY COMPILE_FLAGS
			"-DBOOST_TEST_NO_LIB -DBOOST_TEST_MODULE=${TESTNAME}"
		)
	ELSE()
		SET_PROPERTY(
			TARGET ${TESTNAME}
			PROPERTY COMPILE_FLAGS
			"-DBOOST_TEST_DYN_LINK -DBOOST_TEST_MODULE=${TESTNAME}"
		)
	ENDIF()

	TARGET_LINK_LIBRARIES (${TESTNAME} sgecore ${Boost_UNIT_TEST_FRAMEWORK_LIBRARY})

	ADD_TEST(NAME ${TESTNAME} COMMAND ${TESTNAME})
ENDMACRO()

ADD_SGE_TEST(console/cursor)
ADD_SGE_TEST(parse/json)
